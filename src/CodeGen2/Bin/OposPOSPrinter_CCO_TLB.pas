// *********************************************************************//
// OLE Control Proxy class declaration
// Control Name     : TOPOSPOSPrinter
// Help String      : OPOS POSPrinter Control 1.13.003 [Public, by CRM/MCS]
// Default Interface: IOPOSPOSPrinter
// Def. Intf. DISP? : No
// Event   Interface: _IOPOSPOSPrinterEvents
// TypeFlags        : (2) CanCreate
// *********************************************************************//
  TOPOSPOSPrinterDirectIOEvent = procedure(ASender: TObject; EventNumber: Integer;
                                                             var pData: Integer;
                                                             var pString: WideString) of object;
  TOPOSPOSPrinterErrorEvent = procedure(ASender: TObject; ResultCode: Integer;
                                                          ResultCodeExtended: Integer;
                                                          ErrorLocus: Integer;
                                                          var pErrorResponse: Integer) of object;
  TOPOSPOSPrinterOutputCompleteEvent = procedure(ASender: TObject; OutputID: Integer) of object;
  TOPOSPOSPrinterStatusUpdateEvent = procedure(ASender: TObject; Data: Integer) of object;

  TOPOSPOSPrinter = class(TOleControl)
  private
    FOnDirectIOEvent: TOPOSPOSPrinterDirectIOEvent;
    FOnErrorEvent: TOPOSPOSPrinterErrorEvent;
    FOnOutputCompleteEvent: TOPOSPOSPrinterOutputCompleteEvent;
    FOnStatusUpdateEvent: TOPOSPOSPrinterStatusUpdateEvent;
    FIntf: IOPOSPOSPrinter;
    function  GetControlInterface: IOPOSPOSPrinter;
  protected
    procedure CreateControl;
    procedure InitControlData; override;
  public
    procedure SODataDummy(Status: Integer); safecall;
    procedure SODirectIO(EventNumber: Integer; var pData: Integer; var pString: WideString); safecall;
    procedure SOError(ResultCode: Integer; ResultCodeExtended: Integer; ErrorLocus: Integer; var pErrorResponse: Integer); safecall;
    procedure SOOutputComplete(OutputID: Integer); safecall;
    procedure SOStatusUpdate(Data: Integer); safecall;
    function SOProcessID: Integer; safecall;
    function CheckHealth(Level: Integer): Integer; safecall;
    function ClaimDevice(Timeout: Integer): Integer; safecall;
    function ClearOutput: Integer; safecall;
    function Close: Integer; safecall;
    function DirectIO(Command: Integer; var pData: Integer; var pString: WideString): Integer; safecall;
    function Open(const DeviceName: WideString): Integer; safecall;
    function ReleaseDevice: Integer; safecall;
    function BeginInsertion(Timeout: Integer): Integer; safecall;
    function BeginRemoval(Timeout: Integer): Integer; safecall;
    function CutPaper(Percentage: Integer): Integer; safecall;
    function EndInsertion: Integer; safecall;
    function EndRemoval: Integer; safecall;
    function PrintBarCode(Station: Integer; const Data: WideString; Symbology: Integer; Height: Integer; Width: Integer; Alignment: Integer; TextPosition: Integer): Integer; safecall;
    function PrintBitmap(Station: Integer; const FileName: WideString; Width: Integer; Alignment: Integer): Integer; safecall;
    function PrintImmediate(Station: Integer; const Data: WideString): Integer; safecall;
    function PrintNormal(Station: Integer; const Data: WideString): Integer; safecall;
    function PrintTwoNormal(Stations: Integer; const Data1: WideString; const Data2: WideString): Integer; safecall;
    function RotatePrint(Station: Integer; Rotation: Integer): Integer; safecall;
    function SetBitmap(BitmapNumber: Integer; Station: Integer; const FileName: WideString; Width: Integer; Alignment: Integer): Integer; safecall;
    function SetLogo(Location: Integer; const Data: WideString): Integer; safecall;
    function TransactionPrint(Station: Integer; Control: Integer): Integer; safecall;
    function ValidateData(Station: Integer; const Data: WideString): Integer; safecall;
    function ChangePrintSide(Side: Integer): Integer; safecall;
    function MarkFeed(Type_: Integer): Integer; safecall;
    function ResetStatistics(const StatisticsBuffer: WideString): Integer; safecall;
    function RetrieveStatistics(var pStatisticsBuffer: WideString): Integer; safecall;
    function UpdateStatistics(const StatisticsBuffer: WideString): Integer; safecall;
    function CompareFirmwareVersion(const FirmwareFileName: WideString; out pResult: Integer): Integer; safecall;
    function UpdateFirmware(const FirmwareFileName: WideString): Integer; safecall;
    function ClearPrintArea: Integer; safecall;
    function PageModePrint(Control: Integer): Integer; safecall;
    function PrintMemoryBitmap(Station: Integer; const Data: WideString; Type_: Integer; Width: Integer; Alignment: Integer): Integer; safecall;
    function DrawRuledLine(Station: Integer; const PositionList: WideString; LineDirection: Integer; LineWidth: Integer; LineStyle: Integer; LineColor: Integer): Integer; safecall;
    
    property  ControlInterface: IOPOSPOSPrinter read GetControlInterface;
    property  DefaultInterface: IOPOSPOSPrinter read GetControlInterface;
    property OpenResult: Integer index 49 read GetIntegerProp;
    property CheckHealthText: WideString index 13 read GetWideStringProp;
    property Claimed: WordBool index 14 read GetWordBoolProp;
    property OutputID: Integer index 19 read GetIntegerProp;
    property ResultCode: Integer index 22 read GetIntegerProp;
    property ResultCodeExtended: Integer index 23 read GetIntegerProp;
    property State: Integer index 24 read GetIntegerProp;
    property ControlObjectDescription: WideString index 25 read GetWideStringProp;
    property ControlObjectVersion: Integer index 26 read GetIntegerProp;
    property ServiceObjectDescription: WideString index 27 read GetWideStringProp;
    property ServiceObjectVersion: Integer index 28 read GetIntegerProp;
    property DeviceDescription: WideString index 29 read GetWideStringProp;
    property DeviceName: WideString index 30 read GetWideStringProp;
    property CapConcurrentJrnRec: WordBool index 52 read GetWordBoolProp;
    property CapConcurrentJrnSlp: WordBool index 53 read GetWordBoolProp;
    property CapConcurrentRecSlp: WordBool index 54 read GetWordBoolProp;
    property CapCoverSensor: WordBool index 55 read GetWordBoolProp;
    property CapJrn2Color: WordBool index 56 read GetWordBoolProp;
    property CapJrnBold: WordBool index 57 read GetWordBoolProp;
    property CapJrnDhigh: WordBool index 58 read GetWordBoolProp;
    property CapJrnDwide: WordBool index 59 read GetWordBoolProp;
    property CapJrnDwideDhigh: WordBool index 60 read GetWordBoolProp;
    property CapJrnEmptySensor: WordBool index 61 read GetWordBoolProp;
    property CapJrnItalic: WordBool index 62 read GetWordBoolProp;
    property CapJrnNearEndSensor: WordBool index 63 read GetWordBoolProp;
    property CapJrnPresent: WordBool index 64 read GetWordBoolProp;
    property CapJrnUnderline: WordBool index 65 read GetWordBoolProp;
    property CapRec2Color: WordBool index 66 read GetWordBoolProp;
    property CapRecBarCode: WordBool index 67 read GetWordBoolProp;
    property CapRecBitmap: WordBool index 68 read GetWordBoolProp;
    property CapRecBold: WordBool index 69 read GetWordBoolProp;
    property CapRecDhigh: WordBool index 70 read GetWordBoolProp;
    property CapRecDwide: WordBool index 71 read GetWordBoolProp;
    property CapRecDwideDhigh: WordBool index 72 read GetWordBoolProp;
    property CapRecEmptySensor: WordBool index 73 read GetWordBoolProp;
    property CapRecItalic: WordBool index 74 read GetWordBoolProp;
    property CapRecLeft90: WordBool index 75 read GetWordBoolProp;
    property CapRecNearEndSensor: WordBool index 76 read GetWordBoolProp;
    property CapRecPapercut: WordBool index 77 read GetWordBoolProp;
    property CapRecPresent: WordBool index 78 read GetWordBoolProp;
    property CapRecRight90: WordBool index 79 read GetWordBoolProp;
    property CapRecRotate180: WordBool index 80 read GetWordBoolProp;
    property CapRecStamp: WordBool index 81 read GetWordBoolProp;
    property CapRecUnderline: WordBool index 82 read GetWordBoolProp;
    property CapSlp2Color: WordBool index 83 read GetWordBoolProp;
    property CapSlpBarCode: WordBool index 84 read GetWordBoolProp;
    property CapSlpBitmap: WordBool index 85 read GetWordBoolProp;
    property CapSlpBold: WordBool index 86 read GetWordBoolProp;
    property CapSlpDhigh: WordBool index 87 read GetWordBoolProp;
    property CapSlpDwide: WordBool index 88 read GetWordBoolProp;
    property CapSlpDwideDhigh: WordBool index 89 read GetWordBoolProp;
    property CapSlpEmptySensor: WordBool index 90 read GetWordBoolProp;
    property CapSlpFullslip: WordBool index 91 read GetWordBoolProp;
    property CapSlpItalic: WordBool index 92 read GetWordBoolProp;
    property CapSlpLeft90: WordBool index 93 read GetWordBoolProp;
    property CapSlpNearEndSensor: WordBool index 94 read GetWordBoolProp;
    property CapSlpPresent: WordBool index 95 read GetWordBoolProp;
    property CapSlpRight90: WordBool index 96 read GetWordBoolProp;
    property CapSlpRotate180: WordBool index 97 read GetWordBoolProp;
    property CapSlpUnderline: WordBool index 98 read GetWordBoolProp;
    property CharacterSetList: WideString index 101 read GetWideStringProp;
    property CoverOpen: WordBool index 102 read GetWordBoolProp;
    property ErrorStation: Integer index 104 read GetIntegerProp;
    property JrnEmpty: WordBool index 108 read GetWordBoolProp;
    property JrnLineCharsList: WideString index 111 read GetWideStringProp;
    property JrnLineWidth: Integer index 114 read GetIntegerProp;
    property JrnNearEnd: WordBool index 115 read GetWordBoolProp;
    property RecEmpty: WordBool index 118 read GetWordBoolProp;
    property RecLineCharsList: WideString index 121 read GetWideStringProp;
    property RecLinesToPaperCut: Integer index 124 read GetIntegerProp;
    property RecLineWidth: Integer index 125 read GetIntegerProp;
    property RecNearEnd: WordBool index 126 read GetWordBoolProp;
    property RecSidewaysMaxChars: Integer index 127 read GetIntegerProp;
    property RecSidewaysMaxLines: Integer index 128 read GetIntegerProp;
    property SlpEmpty: WordBool index 131 read GetWordBoolProp;
    property SlpLineCharsList: WideString index 134 read GetWideStringProp;
    property SlpLinesNearEndToEnd: Integer index 136 read GetIntegerProp;
    property SlpLineWidth: Integer index 138 read GetIntegerProp;
    property SlpMaxLines: Integer index 139 read GetIntegerProp;
    property SlpNearEnd: WordBool index 140 read GetWordBoolProp;
    property SlpSidewaysMaxChars: Integer index 141 read GetIntegerProp;
    property SlpSidewaysMaxLines: Integer index 142 read GetIntegerProp;
    property CapCharacterSet: Integer index 51 read GetIntegerProp;
    property CapTransaction: WordBool index 99 read GetWordBoolProp;
    property ErrorLevel: Integer index 103 read GetIntegerProp;
    property ErrorString: WideString index 105 read GetWideStringProp;
    property FontTypefaceList: WideString index 107 read GetWideStringProp;
    property RecBarCodeRotationList: WideString index 117 read GetWideStringProp;
    property SlpBarCodeRotationList: WideString index 130 read GetWideStringProp;
    property CapPowerReporting: Integer index 12 read GetIntegerProp;
    property PowerState: Integer index 21 read GetIntegerProp;
    property CapJrnCartridgeSensor: Integer index 143 read GetIntegerProp;
    property CapJrnColor: Integer index 144 read GetIntegerProp;
    property CapRecCartridgeSensor: Integer index 145 read GetIntegerProp;
    property CapRecColor: Integer index 146 read GetIntegerProp;
    property CapRecMarkFeed: Integer index 147 read GetIntegerProp;
    property CapSlpBothSidesPrint: WordBool index 148 read GetWordBoolProp;
    property CapSlpCartridgeSensor: Integer index 149 read GetIntegerProp;
    property CapSlpColor: Integer index 150 read GetIntegerProp;
    property JrnCartridgeState: Integer index 152 read GetIntegerProp;
    property RecCartridgeState: Integer index 154 read GetIntegerProp;
    property SlpCartridgeState: Integer index 156 read GetIntegerProp;
    property SlpPrintSide: Integer index 158 read GetIntegerProp;
    property CapMapCharacterSet: WordBool index 190 read GetWordBoolProp;
    property RecBitmapRotationList: WideString index 192 read GetWideStringProp;
    property SlpBitmapRotationList: WideString index 193 read GetWideStringProp;
    property CapStatisticsReporting: WordBool index 39 read GetWordBoolProp;
    property CapUpdateStatistics: WordBool index 40 read GetWordBoolProp;
    property CapCompareFirmwareVersion: WordBool index 44 read GetWordBoolProp;
    property CapUpdateFirmware: WordBool index 45 read GetWordBoolProp;
    property CapConcurrentPageMode: WordBool index 194 read GetWordBoolProp;
    property CapRecPageMode: WordBool index 195 read GetWordBoolProp;
    property CapSlpPageMode: WordBool index 196 read GetWordBoolProp;
    property PageModeArea: WideString index 197 read GetWideStringProp;
    property PageModeDescriptor: Integer index 198 read GetIntegerProp;
    property CapRecRuledLine: Integer index 204 read GetIntegerProp;
    property CapSlpRuledLine: Integer index 205 read GetIntegerProp;
  published
    property Anchors;
    property DeviceEnabled: WordBool index 17 read GetWordBoolProp write SetWordBoolProp stored False;
    property FreezeEvents: WordBool index 18 read GetWordBoolProp write SetWordBoolProp stored False;
    property AsyncMode: WordBool index 50 read GetWordBoolProp write SetWordBoolProp stored False;
    property CharacterSet: Integer index 100 read GetIntegerProp write SetIntegerProp stored False;
    property FlagWhenIdle: WordBool index 106 read GetWordBoolProp write SetWordBoolProp stored False;
    property JrnLetterQuality: WordBool index 109 read GetWordBoolProp write SetWordBoolProp stored False;
    property JrnLineChars: Integer index 110 read GetIntegerProp write SetIntegerProp stored False;
    property JrnLineHeight: Integer index 112 read GetIntegerProp write SetIntegerProp stored False;
    property JrnLineSpacing: Integer index 113 read GetIntegerProp write SetIntegerProp stored False;
    property MapMode: Integer index 116 read GetIntegerProp write SetIntegerProp stored False;
    property RecLetterQuality: WordBool index 119 read GetWordBoolProp write SetWordBoolProp stored False;
    property RecLineChars: Integer index 120 read GetIntegerProp write SetIntegerProp stored False;
    property RecLineHeight: Integer index 122 read GetIntegerProp write SetIntegerProp stored False;
    property RecLineSpacing: Integer index 123 read GetIntegerProp write SetIntegerProp stored False;
    property SlpLetterQuality: WordBool index 132 read GetWordBoolProp write SetWordBoolProp stored False;
    property SlpLineChars: Integer index 133 read GetIntegerProp write SetIntegerProp stored False;
    property SlpLineHeight: Integer index 135 read GetIntegerProp write SetIntegerProp stored False;
    property SlpLineSpacing: Integer index 137 read GetIntegerProp write SetIntegerProp stored False;
    property RotateSpecial: Integer index 129 read GetIntegerProp write SetIntegerProp stored False;
    property BinaryConversion: Integer index 11 read GetIntegerProp write SetIntegerProp stored False;
    property PowerNotify: Integer index 20 read GetIntegerProp write SetIntegerProp stored False;
    property CartridgeNotify: Integer index 151 read GetIntegerProp write SetIntegerProp stored False;
    property JrnCurrentCartridge: Integer index 153 read GetIntegerProp write SetIntegerProp stored False;
    property RecCurrentCartridge: Integer index 155 read GetIntegerProp write SetIntegerProp stored False;
    property SlpCurrentCartridge: Integer index 157 read GetIntegerProp write SetIntegerProp stored False;
    property MapCharacterSet: WordBool index 191 read GetWordBoolProp write SetWordBoolProp stored False;
    property PageModeHorizontalPosition: Integer index 199 read GetIntegerProp write SetIntegerProp stored False;
    property PageModePrintArea: WideString index 200 read GetWideStringProp write SetWideStringProp stored False;
    property PageModePrintDirection: Integer index 201 read GetIntegerProp write SetIntegerProp stored False;
    property PageModeStation: Integer index 202 read GetIntegerProp write SetIntegerProp stored False;
    property PageModeVerticalPosition: Integer index 203 read GetIntegerProp write SetIntegerProp stored False;
    property OnDirectIOEvent: TOPOSPOSPrinterDirectIOEvent read FOnDirectIOEvent write FOnDirectIOEvent;
    property OnErrorEvent: TOPOSPOSPrinterErrorEvent read FOnErrorEvent write FOnErrorEvent;
    property OnOutputCompleteEvent: TOPOSPOSPrinterOutputCompleteEvent read FOnOutputCompleteEvent write FOnOutputCompleteEvent;
    property OnStatusUpdateEvent: TOPOSPOSPrinterStatusUpdateEvent read FOnStatusUpdateEvent write FOnStatusUpdateEvent;
  end;


